{{- define "auth_config" -}}
auth_url={{ .KeystoneInternalURL }}
{{ if .UseApplicationCredentials -}}
auth_type=v3applicationcredential
application_credential_id = {{ .ACID }}
application_credential_secret = {{ .ACSecret }}
{{- else -}}
auth_type=password
username={{ .ServiceUser }}
password = {{ .ServicePassword }}
user_domain_name=Default
project_name=service
project_domain_name=Default
{{- end }}
{{ if (index . "Region") -}}
region_name={{ .Region }}
{{ end -}}
{{- end -}}

[DEFAULT]
auth_strategy = keystone
transport_url = {{ .TransportURL }}

[keystone_authtoken]
www_authenticate_uri={{ .KeystonePublicURL }}
{{ template "auth_config" . }}

[service_catalog]
{{ template "auth_config" . }}

[ironic]
{{ template "auth_config" . }}

[agent]
report_interval=30

{{ if (index . "QuorumQueues") }}
[oslo_messaging_rabbit]
rabbit_quorum_queue=true
rabbit_transient_quorum_queue=true
amqp_durable_queues=true
{{ end }}
